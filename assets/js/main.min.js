'use strict';

/*! [PROJECT_NAME] | Suitmedia */

(function (window, document, undefined) {

    var path = {
        css: myPrefix + 'assets/css/',
        js: myPrefix + 'assets/js/vendor/'
    };

    var assets = {
        _objectFit: path.js + 'object-fit-images.min.js'
    };

    var isActive = 'is-active';

    var Site = {
        enableActiveStateMobile: function enableActiveStateMobile() {
            if (document.addEventListener) {
                document.addEventListener('touchstart', function () {}, true);
            }
        },
        WPViewportFix: function WPViewportFix() {
            if ('-ms-user-select' in document.documentElement.style && navigator.userAgent.match(/IEMobile/)) {
                var style = document.createElement('style');
                var fix = document.createTextNode('@-ms-viewport{width:auto!important}');

                style.appendChild(fix);
                document.head.appendChild(style);
            }
        },
        objectFitPolyfill: function objectFitPolyfill() {
            load(assets._objectFit).then(function () {
                objectFitImages();
            });
        },
        angularModule: function angularModule() {
            var app = angular.module('myApp', ['ngRoute', 'ngSanitize']);

            app.controller('mainCtrl', function ($scope, $route) {
                $scope.$route = $route;
            });

            app.controller('homeCtrl', function ($scope) {
                $scope.pageHeader = 'Suitmedia <br>Front-end Styleguides';
            });

            app.controller('cssCtrl', function ($scope) {
                $scope.pageHeader = 'Suitmedia <br>CSS Styleguides';
            });

            app.controller('htmlCtrl', function ($scope) {
                $scope.pageHeader = 'Suitmedia <br>HTML Styleguides';
            });

            app.controller('toolsCtrl', function ($scope) {
                $scope.pageHeader = 'Front-end Tools/Plugins';
            });

            app.controller('jsCtrl', function ($scope) {
                $scope.pageHeader = 'Suitmedia <br>Javascript Styleguides';
            });

            app.config(function ($routeProvider) {
                $routeProvider.when('/', {
                    templateUrl: 'home.html',
                    controller: 'homeCtrl'
                }).when('/css', {
                    templateUrl: 'css.html',
                    controller: 'cssCtrl'
                }).when('/html', {
                    templateUrl: 'html.html',
                    controller: 'htmlCtrl'
                }).when('/tools', {
                    templateUrl: 'tools.html',
                    controller: 'toolsCtrl'
                }).when('/js', {
                    templateUrl: 'js.html',
                    controller: 'jsCtrl'
                });
            });
        }
    };

    Promise.all([]).then(function () {
        for (var fn in Site) {
            Site[fn]();
        }
        window.Site = Site;
    });

    function exist(selector) {
        return new Promise(function (resolve, reject) {
            var $elem = $(selector);

            if ($elem.length) {
                resolve($elem);
            } else {
                reject('no element found for ' + selector);
            }
        });
    }

    function load(url) {
        return new Promise(function (resolve, reject) {
            Modernizr.load({
                load: url,
                complete: resolve
            });
        });
    }

    function loadJSON(url) {
        return new Promise(function (resolve, reject) {
            fetch(url).then(function (res) {
                if (res.ok) {
                    resolve(res.json());
                } else {
                    reject('Network response not ok');
                }
            }).catch(function (e) {
                reject(e);
            });
        });
    }
})(window, document);